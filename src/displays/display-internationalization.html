<!--
@license
Copyright (c) 2017 Swarm City
This code may only be used under the license found at https://github.com/swarmcity/license
-->
<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../data/data-local-storage.html">
<!--

Example:
```
<display-internationalization></display-internationalization>
```

-->
<dom-module id="display-internationalization">
    <template>
        <style>
            :host {
                display: block;
            }
        </style>
        <data-local-storage id="localStorage"></data-local-storage>
    </template>
    <script>

class DisplayInternationalization extends Polymer.Element {
        static get is() { return 'display-internationalization';}
        static get properties() { return {
            language: {
                type: String,
                notify: true,
            },
            select: {
                type: String,
                value: false,
            },
        };
    }
    connectedCallback() {
        super.connectedCallback();
        this.$.localStorage.accountExists()
        .then((account) => {
            if(!account.language){
                const str = navigator.language || navigator.userLanguage;
                const res = str.split("-");
                const language = res[0];
                this.$.localStorage.saveAccount({language:language});
                return language;
            } else {
                const language = account.language;
                return language;
            }
        })
        .then((language) => {
            this.language = language;
        })
        .catch((err) => {
            this.language = 'en'
        });
    }
} window.customElements.define(DisplayInternationalization.is, DisplayInternationalization);
</script>
</dom-module>
