<!--
@license
Copyright (c) 2017 Swarm City
This code may only be used under the license found at https://github.com/swarmcity/license
-->
<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../data/data-local-storage.html">
<link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="display-internationalization.html">
<!--

Example:
```
<display-upload-file></display-upload-file>
```

### Styling

Style the button with CSS as you would a normal DOM element.

The following custom properties and mixins are available for styling:

| Custom property | Description | Default |
| --- | --- | --- |
| `--upload-file` | Mixin applied to the enter here button | `{}` |

-->
<dom-module id="display-upload-file">
    <template>
        <style>
            :host {
                display: block;
            }
            input{
                position: relative;
                height: 100%;
                width: auto;
                opacity: 0;
                z-index: 2;

            }
            label.cabinet{
                width: 60px;
                height: 60px;
                border-radius:50%;
                border: 1px solid black;
                display: block;
                overflow: hidden;
                cursor: pointer;
                z-index: 1;
                @apply --upload-file;
            }
        </style>
        <data-local-storage id="localStorage"></data-local-storage>
        <display-internationalization language="{{language}}"></display-internationalization>

        <label class="cabinet"> 
            <input type="file" class="file" on-change="_getFile"/>
        </label>

        </template>
    <script>

    class DisplayUploadFile extends Polymer.mixinBehaviors([
        Polymer.AppLocalizeBehavior],
        Polymer.Element
    ) {
        static get is() { return 'display-upload-file';}
        static get properties() { return {
            loading: {
                type: Boolean,
                notify: true,
            },
        };
    }


/**
* Fired when the user selects a file
* @param {event} event The event from the on-change
*/
_getFile(event) {
    event.stopPropagation();
    event.preventDefault();
    const file = event.target.files[0];
    this._base64(file);
}
/**
* Converts afile to base 64 for transport
* @param {file} file is a file with type of file
*/
_base64(file) {
    let reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => {
        this._buffer(reader.result);
    };
    reader.onerror = (error) => {
        this.error = error;
    };
}
/**
* Converts base 64 to an array buffer
* @param {base64} base64 string representing
* the image to be converted to an array buffer
*/
_buffer(base64) {
    var len = base64.length;
    var bytes = new Uint8Array( len );
    for (var i = 0; i < len; i++) {
        bytes[i] = base64.charCodeAt(i);
    }
    // console.log(bytes.buffer)
}
// _buffer(file){
//     let reader = new window.FileReader()
//     reader.onloadend = () => this._saveToIpfs(reader)
//     reader.onerror = (error) => {
//         this.error = error
//     };
//     reader.readAsArrayBuffer(file)
// }
// _saveToIpfs(data){
//     console.log(data.result)
// }
} window.customElements.define(DisplayUploadFile.is, DisplayUploadFile);
</script>
</dom-module>
